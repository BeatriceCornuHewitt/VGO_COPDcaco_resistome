---
title: "DESeq analysis with quartiles and halves"
output: html_notebook
---

### DESeq with quartiles and halves
```{r}
# DESeq2 with exposure quantiles
# Now I need to categorise my exposure proxy variables which are currently continuous numeric to quartiles (factor variables)
# I will use the cut() function 
?cut
# MinDistAnyFarm.NEG
Final.ps.DAanalysis.exp.clusternames.quart <- Final.ps.DAanalysis.exp.clusternames
Final.ps.DAanalysis.exp.clusternames.quart@sam_data$MinDistAnyFarm.NEG<-cut(Final.ps.DAanalysis.exp.clusternames.quart@sam_data$MinDistAnyFarm.NEG, breaks=4, labels =c("1st quartile (minDistAnyFarm.NEG)", "2nd quartile (minDistAnyFarm.NEG)", "3rd quartile (minDistAnyFarm.NEG)", "4th quartile (minDistAnyFarm.NEG)"))
# MinDistAnyFarm.INV
Final.ps.DAanalysis.exp.clusternames.quart@sam_data$MinDistAnyFarm.INV<- cut(Final.ps.DAanalysis.exp.clusternames.quart@sam_data$MinDistAnyFarm.INV, breaks=4, labels =c("1st quartile (MinDistAnyFarm.INV)", "2nd quartile (MinDistAnyFarm.INV)", "3rd quartile (MinDistAnyFarm.INV)", "4th quartile (MinDistAnyFarm.INV)"))
# AllFarm.3000m
Final.ps.DAanalysis.exp.clusternames.quart@sam_data$AllFarm.3000m<-cut(Final.ps.DAanalysis.exp.clusternames.quart@sam_data$AllFarm.3000m, breaks=4, labels =c("1st quartile (AllFarm.3000m)", "2nd quartile (AllFarm.3000m)", "3rd quartile (AllFarm.3000m)", "4th quartile (AllFarm.3000m)"))
#AllFarm.1000m
Final.ps.DAanalysis.exp.clusternames.quart@sam_data$AllFarm.1000m<-cut(Final.ps.DAanalysis.exp.clusternames.quart@sam_data$AllFarm.1000m, breaks=4, labels =c("1st quartile (AllFarm.1000m)", "2nd quartile (AllFarm.1000m)", "3rd quartile (AllFarm.1000m)", "4th quartile (AllFarm.1000m)"))
#AllFarm.500m
Final.ps.DAanalysis.exp.clusternames.quart@sam_data$AllFarm.500m<-cut(Final.ps.DAanalysis.exp.clusternames.quart@sam_data$AllFarm.500m, breaks=4, labels =c("1st quartile (AllFarm.500m)", "2nd quartile (AllFarm.500m)", "3rd quartile (AllFarm.500m)", "4th quartile (AllFarm.500m)"))
#AllFarm.250m
Final.ps.DAanalysis.exp.clusternames.quart@sam_data$AllFarm.250m<-cut(Final.ps.DAanalysis.exp.clusternames.quart@sam_data$AllFarm.250m, breaks=4, labels =c("1st quartile (AllFarm.250m)", "2nd quartile (AllFarm.250m)", "3rd quartile (AllFarm.250m)", "4th quartile (AllFarm.250m)"))
#npigsWghtDist.1000m.sum
Final.ps.DAanalysis.exp.clusternames.quart@sam_data$npigsWghtDist.1000m.sum<-cut(Final.ps.DAanalysis.exp.clusternames.quart@sam_data$npigsWghtDist.1000m.sum, breaks=4, labels =c("1st quartile (npigsWghtDist.1000m.sum)", "2nd quartile (npigsWghtDist.1000m.sum)", "3rd quartile (npigsWghtDist.1000m.sum)", "4th quartile (npigsWghtDist.1000m.sum)"))
#npoultryWghtDist.1000m.sum
Final.ps.DAanalysis.exp.clusternames.quart@sam_data$npoultryWghtDist.1000m.sum<-cut(Final.ps.DAanalysis.exp.clusternames.quart@sam_data$npoultryWghtDist.1000m.sum, breaks=4, labels =c("1st quartile (npoultryWghtDist.1000m.sum)", "2nd quartile (npoultryWghtDist.1000m.sum)", "3rd quartile (npoultryWghtDist.1000m.sum)", "4th quartile (npoultryWghtDist.1000m.sum)"))
#ncowsWghtDist.1000m.sum
Final.ps.DAanalysis.exp.clusternames.quart@sam_data$ncowsWghtDist.1000m.sum<- cut(Final.ps.DAanalysis.exp.clusternames.quart@sam_data$ncowsWghtDist.1000m.sum, breaks=4, labels =c("1st quartile (ncowsWghtDist.1000m.sum)", "2nd quartile (ncowsWghtDist.1000m.sum)", "3rd quartile (ncowsWghtDist.1000m.sum)", "4th quartile (ncowsWghtDist.1000m.sum)"))
#nhorsesWghtDist.1000m.sum
Final.ps.DAanalysis.exp.clusternames.quart@sam_data$nhorsesWghtDist.1000m.sum<-cut(Final.ps.DAanalysis.exp.clusternames.quart@sam_data$nhorsesWghtDist.1000m.sum, breaks=4, labels =c("1st quartile (nhorsesWghtDist.1000m.sum)", "2nd quartile (nhorsesWghtDist.1000m.sum)", "3rd quartile (nhorsesWghtDist.1000m.sum)", "4th quartile (nhorsesWghtDist.1000m.sum)"))
#ngoatsWghtDist.1000m.sum
Final.ps.DAanalysis.exp.clusternames.quart@sam_data$ngoatsWghtDist.1000m.sum<-cut(Final.ps.DAanalysis.exp.clusternames.quart@sam_data$ngoatsWghtDist.1000m.sum, breaks=4, labels =c("1st quartile (ngoatsWghtDist.1000m.sum)", "2nd quartile (ngoatsWghtDist.1000m.sum)", "3rd quartile (ngoatsWghtDist.1000m.sum)", "4th quartile (ngoatsWghtDist.1000m.sum)"))
#nsheepWghtDist.1000m.sum
Final.ps.DAanalysis.exp.clusternames.quart@sam_data$nsheepWghtDist.1000m.sum<-cut(Final.ps.DAanalysis.exp.clusternames.quart@sam_data$nsheepWghtDist.1000m.sum, breaks=4, labels =c("1st quartile (nsheepWghtDist.1000m.sum)", "2nd quartile (nsheepWghtDist.1000m.sum)", "3rd quartile (nsheepWghtDist.1000m.sum)", "4th quartile (nsheepWghtDist.1000m.sum)"))
#nfuranimsWghtDist.1000m.sum
Final.ps.DAanalysis.exp.clusternames.quart@sam_data$nfuranimsWghtDist.1000m.sum<-cut(Final.ps.DAanalysis.exp.clusternames.quart@sam_data$nfuranimsWghtDist.1000m.sum, breaks=4, labels =c("1st quartile (nfuranimsWghtDist.1000m.sum)", "2nd quartile (nfuranimsWghtDist.1000m.sum)", "3rd quartile (nfuranimsWghtDist.1000m.sum)", "4th quartile (nfuranimsWghtDist.1000m.sum)"))
#npigsWghtDist.3000m.sum
Final.ps.DAanalysis.exp.clusternames.quart@sam_data$npigsWghtDist.3000m.sum<-cut(Final.ps.DAanalysis.exp.clusternames.quart@sam_data$npigsWghtDist.3000m.sum, breaks=4, labels =c("1st quartile (npigsWghtDist.3000m.sum)", "2nd quartile (npigsWghtDist.3000m.sum)", "3rd quartile (npigsWghtDist.3000m.sum)", "4th quartile (npigsWghtDist.3000m.sum)"))
#npoultryWghtDist.3000m.sum
Final.ps.DAanalysis.exp.clusternames.quart@sam_data$npoultryWghtDist.3000m.sum<-cut(Final.ps.DAanalysis.exp.clusternames.quart@sam_data$npoultryWghtDist.3000m.sum, breaks=4, labels =c("1st quartile (npoultryWghtDist.3000m.sum)", "2nd quartile (npoultryWghtDist.3000m.sum)", "3rd quartile (npoultryWghtDist.3000m.sum)", "4th quartile (npoultryWghtDist.3000m.sum)"))
#ncowsWghtDist.3000m.sum
Final.ps.DAanalysis.exp.clusternames.quart@sam_data$ncowsWghtDist.3000m.sum<-cut(Final.ps.DAanalysis.exp.clusternames.quart@sam_data$ncowsWghtDist.3000m.sum, breaks=4, labels =c("1st quartile (ncowsWghtDist.3000m.sum)", "2nd quartile (ncowsWghtDist.3000m.sum)", "3rd quartile (ncowsWghtDist.3000m.sum)", "4th quartile (ncowsWghtDist.3000m.sum)"))
#nhorsesWghtDist.3000m.sum
Final.ps.DAanalysis.exp.clusternames.quart@sam_data$nhorsesWghtDist.3000m.sum<-cut(Final.ps.DAanalysis.exp.clusternames.quart@sam_data$nhorsesWghtDist.3000m.sum, breaks=4, labels =c("1st quartile (nhorsesWghtDist.3000m.sum)", "2nd quartile (nhorsesWghtDist.3000m.sum)", "3rd quartile (nhorsesWghtDist.3000m.sum)", "4th quartile (nhorsesWghtDist.3000m.sum)"))
#ngoatsWghtDist.3000m.sum
Final.ps.DAanalysis.exp.clusternames.quart@sam_data$ngoatsWghtDist.3000m.sum<-cut(Final.ps.DAanalysis.exp.clusternames.quart@sam_data$ngoatsWghtDist.3000m.sum, breaks=4, labels =c("1st quartile (ngoatsWghtDist.3000m.sum)", "2nd quartile (ngoatsWghtDist.3000m.sum)", "3rd quartile (ngoatsWghtDist.3000m.sum)", "4th quartile (ngoatsWghtDist.3000m.sum)"))
#nsheepWghtDist.3000m.sum
Final.ps.DAanalysis.exp.clusternames.quart@sam_data$nsheepWghtDist.3000m.sum<-cut(Final.ps.DAanalysis.exp.clusternames.quart@sam_data$nsheepWghtDist.3000m.sum, breaks=4, labels =c("1st quartile (nsheepWghtDist.3000m.sum)", "2nd quartile (nsheepWghtDist.3000m.sum)", "3rd quartile (nsheepWghtDist.3000m.sum)", "4th quartile (nsheepWghtDist.3000m.sum)"))
#nfuranimsWghtDist.3000m.sum
Final.ps.DAanalysis.exp.clusternames.quart@sam_data$nfuranimsWghtDist.3000m.sum<-cut(Final.ps.DAanalysis.exp.clusternames.quart@sam_data$nfuranimsWghtDist.3000m.sum, breaks=4, labels =c("1st quartile (nfuranimsWghtDist.3000m.sum)", "2nd quartile (nfuranimsWghtDist.3000m.sum)", "3rd quartile (nfuranimsWghtDist.3000m.sum)", "4th quartile (nfuranimsWghtDist.3000m.sum)"))
#nAnyFarmWghtDist.1000m.sum
Final.ps.DAanalysis.exp.clusternames.quart@sam_data$nAnyFarmWghtDist.1000m.sum<-cut(Final.ps.DAanalysis.exp.clusternames.quart@sam_data$nAnyFarmWghtDist.1000m.sum, breaks=4, labels =c("1st quartile (nAnyFarmWghtDist.1000m.sum)", "2nd quartile (nAnyFarmWghtDist.1000m.sum)", "3rd quartile (nAnyFarmWghtDist.1000m.sum)", "4th quartile (nAnyFarmWghtDist.1000m.sum)"))
#nAnyFarmWghtDist.3000m.sum
Final.ps.DAanalysis.exp.clusternames.quart@sam_data$nAnyFarmWghtDist.3000m.sum<-cut(Final.ps.DAanalysis.exp.clusternames.quart@sam_data$nAnyFarmWghtDist.3000m.sum, breaks=4, labels =c("1st quartile (nAnyFarmWghtDist.3000m.sum)", "2nd quartile (nAnyFarmWghtDist.3000m.sum)", "3rd quartile (nAnyFarmWghtDist.3000m.sum)", "4th quartile (nAnyFarmWghtDist.3000m.sum)"))
#DISP_EUinPM10_AnnualAv_WP99.5
Final.ps.DAanalysis.exp.clusternames.quart@sam_data$DISP_EUinPM10_AnnualAv_WP99.5<- cut(Final.ps.DAanalysis.exp.clusternames.quart@sam_data$DISP_EUinPM10_AnnualAv_WP99.5, breaks=4, labels =c("1st quartile (DISP_EUinPM10_AnnualAv_WP99.5)", "2nd quartile (DISP_EUinPM10_AnnualAv_WP99.5)", "3rd quartile (DISP_EUinPM10_AnnualAv_WP99.5)", "4th quartile (DISP_EUinPM10_AnnualAv_WP99.5)"))
#DISP_PM10CONC_AnnualAv_WP99.5
Final.ps.DAanalysis.exp.clusternames.quart@sam_data$DISP_PM10CONC_AnnualAv_WP99.5<- cut(Final.ps.DAanalysis.exp.clusternames.quart@sam_data$DISP_PM10CONC_AnnualAv_WP99.5, breaks=4, labels =c("1st quartile (DISP_PM10CONC_AnnualAv_WP99.5)", "2nd quartile (DISP_PM10CONC_AnnualAv_WP99.5)", "3rd quartile (DISP_PM10CONC_AnnualAv_WP99.5)", "4th quartile (DISP_PM10CONC_AnnualAv_WP99.5)"))


#Inspect the new ps object
Final.ps.DAanalysis.exp.clusternames.quart
Final.ps.DAanalysis.exp.clusternames.quart@otu_table # clusters labelled correctly 
Final.ps.DAanalysis.exp.clusternames.quart@sam_data # exposure proxy sample data added 
Final.ps.DAanalysis.exp.clusternames.quart@sam_data$MinDistAnyFarm.NEG # exposure proxy data is in quartiles 
# Now ready to run the deseq2 analysis using the phyloseq_to_deseq2 function
# Convert phyloseq data to DESeq2 dataset object - start with endotoxin concentration
deseq2.exp.DISP_EUinPM10_AnnualAv_WP99.5.quart <- phyloseq_to_deseq2(Final.ps.DAanalysis.exp.clusternames.quart,~DISP_EUinPM10_AnnualAv_WP99.5)

# RUN  DESeq function 
deseq2.exp.DISP_EUinPM10_AnnualAv_WP99.5.quart <- DESeq(deseq2.exp.DISP_EUinPM10_AnnualAv_WP99.5.quart)
deseq2.results.exp.DISP_EUinPM10_AnnualAv_WP99.5.quart <- results(deseq2.exp.DISP_EUinPM10_AnnualAv_WP99.5.quart)
deseq2.results.exp.DISP_EUinPM10_AnnualAv_WP99.5.quart
#summary of differential gene expression
summary(deseq2.results.exp.DISP_EUinPM10_AnnualAv_WP99.5.quart)
head(deseq2.results.exp.DISP_EUinPM10_AnnualAv_WP99.5.quart)

# Information about which variables and tests were used for the results is given by this function
mcols(deseq2.results.exp.DISP_EUinPM10_AnnualAv_WP99.5.quart)$description

# Order the results table by the smallest p value:
deseq2.results.exp.DISP_EUinPM10_AnnualAv_WP99.5.quart.ordered <- deseq2.results.exp.DISP_EUinPM10_AnnualAv_WP99.5.quart[order(deseq2.results.exp.DISP_EUinPM10_AnnualAv_WP99.5.quart$pvalue),]
deseq2.results.exp.DISP_EUinPM10_AnnualAv_WP99.5.ordered # No ARGs have padj <0.1 

# How many adjusted p-values are < 0.1? 
sum(deseq2.results.exp.DISP_EUinPM10_AnnualAv_WP99.5.quart$padj < 0.1, na.rm=TRUE) # 0 ARG clusters have padj <0.1


#PM10 concentration 
deseq2.exp.DISP_PM10CONC_AnnualAv_WP99.5.quart <- phyloseq_to_deseq2(Final.ps.DAanalysis.exp.clusternames.quart,~DISP_PM10CONC_AnnualAv_WP99.5)

# RUN  DESeq function 
deseq2.exp.DISP_PM10CONC_AnnualAv_WP99.5.quart <- DESeq(deseq2.exp.DISP_PM10CONC_AnnualAv_WP99.5.quart)
deseq2.results.exp.DISP_PM10CONC_AnnualAv_WP99.5.quart <- results(deseq2.exp.DISP_PM10CONC_AnnualAv_WP99.5.quart)
deseq2.results.exp.DISP_PM10CONC_AnnualAv_WP99.5.quart
#summary of differential gene expression
summary(deseq2.results.exp.DISP_PM10CONC_AnnualAv_WP99.5.quart)
head(deseq2.results.exp.DISP_PM10CONC_AnnualAv_WP99.5.quart)

# Information about which variables and tests were used for the results is given by this function
mcols(deseq2.results.exp.DISP_PM10CONC_AnnualAv_WP99.5.quart)$description

# Order the results table by the smallest p value:
deseq2.results.exp.DISP_PM10CONC_AnnualAv_WP99.5.quart.ordered <- deseq2.results.exp.DISP_PM10CONC_AnnualAv_WP99.5.quart[order(deseq2.results.exp.DISP_PM10CONC_AnnualAv_WP99.5.quart$pvalue),]
deseq2.results.exp.DISP_PM10CONC_AnnualAv_WP99.5.quart.ordered # No ARGs have padj <0.1 

# How many adjusted p-values are < 0.1? 
sum(deseq2.results.exp.DISP_EUinPM10_AnnualAv_WP99.5.quart$padj < 0.1, na.rm=TRUE) # 0 ARG clusters have padj <0.1


# convert exposure proxies into top and bottom halves 
#DISP_EUinPM10_AnnualAv_WP99.5
Final.ps.DAanalysis.exp.clusternames.half <- Final.ps.DAanalysis.exp.clusternames

Final.ps.DAanalysis.exp.clusternames.half@sam_data$DISP_EUinPM10_AnnualAv_WP99.5<- cut(Final.ps.DAanalysis.exp.clusternames.half@sam_data$DISP_EUinPM10_AnnualAv_WP99.5, breaks=2, labels =c("Top half (DISP_EUinPM10_AnnualAv_WP99.5)", "Bottom half (DISP_EUinPM10_AnnualAv_WP99.5)"))
#DISP_PM10CONC_AnnualAv_WP99.5
Final.ps.DAanalysis.exp.clusternames.half@sam_data$DISP_PM10CONC_AnnualAv_WP99.5<- cut(Final.ps.DAanalysis.exp.clusternames.half@sam_data$DISP_PM10CONC_AnnualAv_WP99.5, breaks=2, labels =c("Top half (DISP_PM10CONC_AnnualAv_WP99.5)", "Bottom half (DISP_PM10CONC_AnnualAv_WP99.5)"))

#Re-run Deseq2 with 'halved' data rather than in quartiles 
# Convert phyloseq data to DESeq2 dataset object - start with endotoxin concentration
deseq2.exp.DISP_EUinPM10_AnnualAv_WP99.5.half <- phyloseq_to_deseq2(Final.ps.DAanalysis.exp.clusternames.half,~DISP_EUinPM10_AnnualAv_WP99.5)

# RUN  DESeq function 
deseq2.exp.DISP_EUinPM10_AnnualAv_WP99.5.half <- DESeq(deseq2.exp.DISP_EUinPM10_AnnualAv_WP99.5.half)
deseq2.results.exp.DISP_EUinPM10_AnnualAv_WP99.5.half <- results(deseq2.exp.DISP_EUinPM10_AnnualAv_WP99.5.half)
deseq2.results.exp.DISP_EUinPM10_AnnualAv_WP99.5.half
#summary of differential gene expression
summary(deseq2.results.exp.DISP_EUinPM10_AnnualAv_WP99.5.half)
head(deseq2.results.exp.DISP_EUinPM10_AnnualAv_WP99.5.half)

# Information about which variables and tests were used for the results is given by this function
mcols(deseq2.results.exp.DISP_EUinPM10_AnnualAv_WP99.5.half)$description

# Order the results table by the smallest p value:
deseq2.results.exp.DISP_EUinPM10_AnnualAv_WP99.5.half.ordered <- deseq2.results.exp.DISP_EUinPM10_AnnualAv_WP99.5.half[order(deseq2.results.exp.DISP_EUinPM10_AnnualAv_WP99.5.half$pvalue),]
deseq2.results.exp.DISP_EUinPM10_AnnualAv_WP99.5.half.ordered # No ARGs have padj <0.1 

# How many adjusted p-values are < 0.1? 
sum(deseq2.results.exp.DISP_EUinPM10_AnnualAv_WP99.5.half.ordered$padj < 0.1, na.rm=TRUE) # 0 ARG clusters have padj <0.1


#PM10 concentration 
deseq2.exp.DISP_PM10CONC_AnnualAv_WP99.5.half <- phyloseq_to_deseq2(Final.ps.DAanalysis.exp.clusternames.half,~DISP_PM10CONC_AnnualAv_WP99.5)

# RUN  DESeq function 
deseq2.exp.DISP_PM10CONC_AnnualAv_WP99.5.half <- DESeq(deseq2.exp.DISP_PM10CONC_AnnualAv_WP99.5.half)
deseq2.results.exp.DISP_PM10CONC_AnnualAv_WP99.5.half <- results(deseq2.exp.DISP_PM10CONC_AnnualAv_WP99.5.half)
deseq2.results.exp.DISP_PM10CONC_AnnualAv_WP99.5.half
#summary of differential gene expression
summary(deseq2.results.exp.DISP_PM10CONC_AnnualAv_WP99.5.half)
head(deseq2.results.exp.DISP_PM10CONC_AnnualAv_WP99.5.half)

# Information about which variables and tests were used for the results is given by this function
mcols(deseq2.results.exp.DISP_PM10CONC_AnnualAv_WP99.5.half)$description

# Order the results table by the smallest p value:
deseq2.results.exp.DISP_PM10CONC_AnnualAv_WP99.5.half.ordered <- deseq2.results.exp.DISP_PM10CONC_AnnualAv_WP99.5.half[order(deseq2.results.exp.DISP_PM10CONC_AnnualAv_WP99.5.half$pvalue),]
deseq2.results.exp.DISP_PM10CONC_AnnualAv_WP99.5.half.ordered # No ARGs have padj <0.1 

# How many adjusted p-values are < 0.1? 
sum(deseq2.results.exp.DISP_PM10CONC_AnnualAv_WP99.5.half$padj < 0.1, na.rm=TRUE) # 0 ARG clusters have padj <0.1

# Now I will look at some of the other exposure variables 
#nhorsesWghtDist.1000m.sum
Final.ps.DAanalysis.exp.clusternames.half <- Final.ps.DAanalysis.exp.clusternames

Final.ps.DAanalysis.exp.clusternames.half@sam_data$nhorsesWghtDist.1000m.sum<- cut(Final.ps.DAanalysis.exp.clusternames.half@sam_data$nhorsesWghtDist.1000m.sum, breaks=2, labels =c("Top half (nhorsesWghtDist.1000m.sum)", "Bottom half (nhorsesWghtDist.1000m.sum)"))
deseq2.exp.nhorsesWghtDist.1000m.sum.half <- phyloseq_to_deseq2(Final.ps.DAanalysis.exp.clusternames.half,~nhorsesWghtDist.1000m.sum)
# RUN  DESeq function 
deseq2.exp.nhorsesWghtDist.1000m.sum.half <- DESeq(deseq2.exp.nhorsesWghtDist.1000m.sum.half)
deseq2.results.exp.nhorsesWghtDist.1000m.sum.half <- results(deseq2.exp.nhorsesWghtDist.1000m.sum.half)
deseq2.results.exp.nhorsesWghtDist.1000m.sum.half
#summary of differential gene expression
summary(deseq2.results.exp.nhorsesWghtDist.1000m.sum.half)
head(deseq2.results.exp.nhorsesWghtDist.1000m.sum.half)
# Information about which variables and tests were used for the results is given by this function
mcols(deseq2.results.exp.nhorsesWghtDist.1000m.sum.half)$description
# Order the results table by the smallest p value:
deseq2.results.exp.nhorsesWghtDist.1000m.sum.half.ordered <- deseq2.results.exp.nhorsesWghtDist.1000m.sum.half[order(deseq2.results.exp.nhorsesWghtDist.1000m.sum.half$pvalue),]
deseq2.results.exp.nhorsesWghtDist.1000m.sum.half.ordered 
# How many adjusted p-values are < 0.1? 
sum(deseq2.results.exp.nhorsesWghtDist.1000m.sum.half.ordered$padj < 0.1, na.rm=TRUE) # 4 ARG clusters have padj <0.1

barchart(Final.ps.DAanalysis.exp.clusternames.half@sam_data$nhorsesWghtDist.1000m.sum)
```